{
  "hash": "07ac98c52a34f04b194bc2232e96b107",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 'Least Squares Solution for Inconsistent Systems'\nauthor: 'Nathan Lunceford'\nformat:\n  html:\n    self-contained: true\n    page-layout: full\n    toc: true\n    toc-depth: 3\n    toc-location: right\n    number-sections: false\n    html-math-method: katex\n    embed-resources: true\n    code-fold: true\n    code-summary: 'Show Code'\n    code-overflow: wrap\n    code-copy: hover\n    code-tools:\n      source: false\n      toggle: true\n      caption: See code\nengine: jupyter\npreview:\n  port: 3000\n  browser: true\n  watch-inputs: true\n  navigate: true\n---\n\n\n## Overview\n\nThe least squares solution minimizes the distance between the vector $\\mathbf{b}$ and the column space of $A$. The column space of $A$, denoted $\\mathrm{Col}(A)$, is equivalent to the span of the columns of $A$, written as $\\mathrm{span}(A_1, A_2, \\dots, A_n)$, where $A_1, A_2, \\dots, A_n$ are the columns of $A$.\n\nThis distance corresponds to the residual $\\|\\mathbf{b} - \\mathbf{\\hat{b}}\\|$, where $\\mathbf{\\hat{b}} = A\\mathbf{\\hat{x}}$ is the projection of $\\mathbf{b}$ onto $\\mathrm{Col}(A)$.\n\n## **Visualizing the Least Squares Solution**\n\nThe figure below illustrates how the least squares solution $\\mathbf{\\hat{x}}$ projects $\\mathbf{b}$ onto $\\mathrm{Col}(A)$, which is spanned by the columns of $A$. The vector $\\mathbf{r} = \\mathbf{b} - \\mathbf{\\hat{b}}$ is orthogonal to $\\mathrm{Col}(A)$.\n\n![](least-squares.jpg)\n\n- **$\\mathbf{b}$**: The target vector outside $\\mathrm{Col}(A)$.\n- **$\\mathbf{\\hat{b}}$**: The projection of $\\mathbf{b}$ onto $\\mathrm{Col}(A)$, calculated as $\\mathbf{\\hat{b}} = A(A^\\top A)^{-1}A^\\top \\mathbf{b}$.\n- **$\\mathbf{r}$**: The residual vector, orthogonal to $\\mathrm{Col}(A)$.\n- **$A_1, A_2, \\dots, A_n$**: Basis vectors spanning $\\mathrm{Col}(A)$.\n\n## Intuitive Walkthrough of the Proof\n\n### 1. **The Problem**\n\nGiven a matrix $A$ with columns $A_1, A_2, \\dots, A_n$ and a vector $\\mathbf{b}$, the system $A\\mathbf{x} = \\mathbf{b}$ is inconsistent if $\\mathbf{b}$ does not lie in $\\mathrm{Col}(A)$. The objective is to find $\\mathbf{\\hat{x}}$, which minimizes the distance between $\\mathbf{b}$ and $\\mathrm{Col}(A)$.\n\n### 2. **Projection and Residual**\n\nMinimizing the distance involves projecting $\\mathbf{b}$ onto $\\mathrm{Col}(A)$. The projection is denoted $\\mathbf{\\hat{b}} = A\\mathbf{\\hat{x}}$. The residual $\\mathbf{r} = \\mathbf{b} - \\mathbf{\\hat{b}}$ represents the difference, and the goal is to minimize $\\|\\mathbf{r}\\|^2$, which can be written as:\n\n$$\n\\|\\mathbf{r}\\|^2 = \\|\\mathbf{b} - A\\mathbf{\\hat{x}}\\|^2.\n$$\n\n### 3. **Orthogonality Condition**\n\nThe residual $\\mathbf{r}$ is orthogonal to $\\mathrm{Col}(A)$ when $\\mathbf{\\hat{b}}$ is the best approximation of $\\mathbf{b}$. This condition is expressed as:\n\n$$\nA^\\top \\mathbf{r} = 0 \\quad \\text{or equivalently} \\quad A^\\top (\\mathbf{b} - A\\mathbf{\\hat{x}}) = 0.\n$$\n\n### 4. **Normal Equations**\n\nExpanding the orthogonality condition yields:\n\n$$\nA^\\top \\mathbf{b} - A^\\top A\\mathbf{\\hat{x}} = 0 \\quad \\Rightarrow \\quad A^\\top A\\mathbf{\\hat{x}} = A^\\top \\mathbf{b}.\n$$\n\nThis is the **normal equation**. Solving it provides $\\mathbf{\\hat{x}}$, the least squares solution.\n\n### 5. **Computing $\\mathbf{\\hat{x}}$**\n\nIf $A^\\top A$ is invertible, the solution for $\\mathbf{\\hat{x}}$ is:\n\n$$\n\\mathbf{\\hat{x}} = (A^\\top A)^{-1}A^\\top \\mathbf{b}.\n$$\n\n### 6. **Geometric Interpretation**\n\nThe projection $\\mathbf{\\hat{b}}$ lies in $\\mathrm{Col}(A)$, and the residual $\\mathbf{r} = \\mathbf{b} - \\mathbf{\\hat{b}}$ is orthogonal to this space. This makes $\\mathbf{\\hat{b}}$ the closest vector in $\\mathrm{Col}(A)$ to $\\mathbf{b}$.\n\n## **Summary**\n\nThe least squares method projects $\\mathbf{b}$ onto $\\mathrm{Col}(A)$, solving the equation:\n\n$$\nA^\\top A\\mathbf{\\hat{x}} = A^\\top \\mathbf{b}.\n$$\n\nThe solution is:\n\n$$\n\\mathbf{\\hat{x}} = (A^\\top A)^{-1}A^\\top \\mathbf{b}.\n$$\n\nThis projection minimizes the residual $\\|\\mathbf{b} - \\mathbf{\\hat{b}}\\|$, making it the best approximation of $\\mathbf{b}$ within $\\mathrm{Col}(A)$. The accompanying diagram visually demonstrates this projection and the orthogonal residual.\n\n",
    "supporting": [
      "least-squares_files"
    ],
    "filters": [],
    "includes": {}
  }
}