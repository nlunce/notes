{
  "hash": "602eecad6d09f7743553fe29d176d6a1",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 'Exercise 4.1.2a (C4-P1)'\nauthor: 'Nathan Lunceford'\nformat:\n  html:\n    self-contained: true\n    page-layout: full\n    toc: true\n    toc-depth: 1\n    toc-location: right\n    number-sections: false\n    html-math-method: katex\n    embed-resources: true\n    code-fold: true\n    code-summary: 'Show the code'\n    code-overflow: wrap\n    code-copy: hover\n    code-tools:\n      source: false\n      toggle: true\n      caption: See code\nengine: jupyter\npreview:\n  port: 3000\n  browser: true\n  watch-inputs: true\n  navigate: true\n---\n\n\n# **Problem:**\n\n::: {.callout-note icon=false }\n\n## **4.1.2a**\n\nFind the least squares solution $\\mathbf{\\hat{x}}$ and the RMSE of the following system:\n\n$$\n\\begin{bmatrix}\n1 & 1 & 0 \\\\\n0 & 1 & 1 \\\\\n1 & 2 & 1 \\\\\n1 & 0 & 1\n\\end{bmatrix}\n\\begin{bmatrix}\nx_1 \\\\ x_2 \\\\ x_3\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2 \\\\ 2 \\\\ 3 \\\\ 4\n\\end{bmatrix}\n$$\n\n:::\n\n# **Solution:**\n\n### **Compute $A^\\top A$ and $A^\\top \\mathbf{b}$**\n\nThe transpose of $A$ is:\n\n$$\nA^\\top =\n\\begin{bmatrix}\n1 & 0 & 1 & 1 \\\\\n1 & 1 & 2 & 0 \\\\\n0 & 1 & 1 & 1\n\\end{bmatrix}\n$$\n\nCompute $A^\\top A$:\n\n$$\nA^\\top A =\n\\begin{bmatrix}\n3 & 3 & 2 \\\\\n3 & 6 & 3 \\\\\n2 & 3 & 3\n\\end{bmatrix}\n$$\n\nCompute $A^\\top \\mathbf{b}$:\n\n$$\nA^\\top \\mathbf{b} =\n\\begin{bmatrix}\n9 \\\\ 10 \\\\ 9\n\\end{bmatrix}\n$$\n\nThe normal equation is:\n\n$$\nA^\\top A \\mathbf{\\hat{x}} = A^\\top \\mathbf{b}\n$$\n\n### **Solve $A^\\top A \\mathbf{\\hat{x}} = A^\\top \\mathbf{b}$ using Row Reduction**\n\nThe augmented matrix for the system is:\n\n$$\n\\left[\n\\begin{array}{ccc|c}\n3 & 3 & 2 & 9 \\\\\n3 & 6 & 3 & 10 \\\\\n2 & 3 & 3 & 9\n\\end{array}\n\\right]\n$$\n\n#### Normalize Row 1\n\nDivide Row 1 by 3:\n\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & \\frac{2}{3} & 3 \\\\\n3 & 6 & 3 & 10 \\\\\n2 & 3 & 3 & 9\n\\end{array}\n\\right]\n$$\n\n#### Eliminate the first column in Rows 2 and 3\n\n- $R_2 \\to R_2 - 3R_1$\n- $R_3 \\to R_3 - 2R_1$\n\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & \\frac{2}{3} & 3 \\\\\n0 & 3 & 1 & 1 \\\\\n0 & 1 & \\frac{5}{3} & 3\n\\end{array}\n\\right]\n$$\n\n#### Normalize Row 2\n\nDivide Row 2 by 3:\n\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & \\frac{2}{3} & 3 \\\\\n0 & 1 & \\frac{1}{3} & \\frac{1}{3} \\\\\n0 & 1 & \\frac{5}{3} & 3\n\\end{array}\n\\right]\n$$\n\n#### Eliminate the second column in Rows 1 and 3\n\n- $R_1 \\to R_1 - R_2$\n- $R_3 \\to R_3 - R_2$\n\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 0 & \\frac{4}{9} & \\frac{8}{3} \\\\\n0 & 1 & \\frac{1}{3} & \\frac{1}{3} \\\\\n0 & 0 & \\frac{4}{3} & \\frac{8}{3}\n\\end{array}\n\\right]\n$$\n\n#### Normalize Row 3\n\nDivide Row 3 by $\\frac{4}{3}$:\n\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 0 & \\frac{4}{9} & \\frac{8}{3} \\\\\n0 & 1 & \\frac{1}{3} & \\frac{1}{3} \\\\\n0 & 0 & 1 & 2\n\\end{array}\n\\right]\n$$\n\n#### Eliminate the third column in Rows 1 and 2\n\n- $R_1 \\to R_1 - \\frac{4}{9}R_3$\n- $R_2 \\to R_2 - \\frac{1}{3}R_3$\n\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 0 & 0 & 2 \\\\\n0 & 1 & 0 & -\\frac{1}{3} \\\\\n0 & 0 & 1 & 2\n\\end{array}\n\\right]\n$$\n\nThus, the least squares solution is:\n\n$$\n\\mathbf{\\hat{x}} =\n\\begin{bmatrix}\n2 \\\\ -\\frac{1}{3} \\\\ 2\n\\end{bmatrix}\n$$\n\n### **Compute the Residual**\n\nThe residual is:\n\n$$\n\\mathbf{r} = \\mathbf{b} - A\\mathbf{\\hat{x}}.\n$$\n\nSubstituting $\\mathbf{\\hat{x}}$:\n\n$$\n\\mathbf{r} =\n\\begin{bmatrix}\n2 \\\\ 2 \\\\ 3 \\\\ 4\n\\end{bmatrix}\n-\n\\begin{bmatrix}\n1 + (-\\frac{1}{3}) \\\\ -\\frac{1}{3} + 2 \\\\ 2 + 2(-\\frac{1}{3}) + 2 \\\\ 2 + 2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\frac{1}{3} \\\\ \\frac{1}{3} \\\\ -\\frac{1}{3} \\\\ 0\n\\end{bmatrix}\n$$\n\n### **Compute RMSE**\n\nThe RMSE is given by:\n\n$$\n\\text{RMSE} = \\sqrt{\\frac{\\|\\mathbf{r}\\|^2}{n}}\n$$\n\nFirst, compute $\\|\\mathbf{r}\\|^2$:\n\n$$\n\\|\\mathbf{r}\\|^2 = \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 + \\left(-\\frac{1}{3}\\right)^2 + 0^2 = \\frac{1}{9} + \\frac{1}{9} + \\frac{1}{9} = \\frac{1}{3}\n$$\n\nSubstitute into the RMSE formula:\n\n$$\n\\text{RMSE} = \\sqrt{\\frac{\\frac{1}{3}}{4}} = \\sqrt{\\frac{1}{12}}\n$$\n\nThe approximate value is:\n\n$$\n\\text{RMSE} \\approx 0.2887\n$$\n\n::: {.callout-tip icon=false}\n\n## **Final Answer:**\n\n1. **Least Squares Solution**:\n\n   $$\n   \\hat{x}_1 = 2, \\quad \\hat{x}_2 = -\\frac{1}{3}, \\quad \\hat{x}_3 = 2\n   $$\n\n2. **Residual**:\n\n   $$\n   \\mathbf{r} =\\begin{bmatrix}\\frac{1}{3} \\\\ \\frac{1}{3} \\\\ -\\frac{1}{3} \\\\ 0 \\end{bmatrix}\n   $$\n\n3. **RMSE**:\n   $$\n   \\sqrt{\\frac{1}{12}} \\approx 0.2887\n   $$\n\n:::\n\n",
    "supporting": [
      "exercise4-1-2a_files"
    ],
    "filters": [],
    "includes": {}
  }
}