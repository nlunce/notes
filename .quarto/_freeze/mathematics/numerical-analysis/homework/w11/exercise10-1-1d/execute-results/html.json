{
  "hash": "7ecae95f217b489dbc48d8c80b568a45",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 'Exercise 4.3.1d'\nauthor: 'Nathan Lunceford'\nformat:\n  html:\n    self-contained: true\n    page-layout: full\n    toc: true\n    toc-depth: 1\n    toc-location: right\n    number-sections: false\n    html-math-method: katex\n    embed-resources: true\n    code-fold: true\n    code-summary: 'Show the code'\n    code-overflow: wrap\n    code-copy: hover\n    code-tools:\n      source: false\n      toggle: true\n      caption: See code\nengine: jupyter\npreview:\n  port: 3000\n  browser: true\n  watch-inputs: true\n  navigate: true\n---\n\n\n# **Problem**\n\n::: {.callout-note icon=false }\n\n## **4.3.1d**\n\nApply classical Gramâ€“Schmidt orthogonalization to find the full QR factorization of the matrix:\n\n$$\n\\mathbf{A} = \\begin{bmatrix} 4 & 8 & 1 \\\\ 0 & 2 & -2 \\\\ 3 & 6 & 7 \\end{bmatrix}\n$$\n\n:::\n\n# **Solution**\n\n## Define the Columns of Matrix $\\mathbf{A}$\n\nRepresent the columns of $\\mathbf{A}$ as vectors:\n\n$$\n\\mathbf{a}_1 = \\begin{bmatrix} 4 \\\\ 0 \\\\ 3 \\end{bmatrix}, \\quad \\mathbf{a}_2 = \\begin{bmatrix} 8 \\\\ 2 \\\\ 6 \\end{bmatrix}, \\quad \\mathbf{a}_3 = \\begin{bmatrix} 1 \\\\ -2 \\\\ 7 \\end{bmatrix}\n$$\n\n## Finding $\\mathbf{q}_1$\n\nTo find the first orthonormal vector $\\mathbf{q}_1$, normalize $\\mathbf{a}_1$.\n\n1. **Calculate the norm of $\\mathbf{a}_1$**:\n\n   $$\n   \\|\\mathbf{a}_1\\| = \\sqrt{4^2 + 0^2 + 3^2} = \\sqrt{16 + 9} = \\sqrt{25} = 5\n   $$\n\n2. **Normalize $\\mathbf{a}_1$**:\n\n   $$\n   \\mathbf{q}_1 = \\frac{\\mathbf{a}_1}{\\|\\mathbf{a}_1\\|} = \\frac{1}{5} \\begin{bmatrix} 4 \\\\ 0 \\\\ 3 \\end{bmatrix} = \\begin{bmatrix} \\frac{4}{5} \\\\ 0 \\\\ \\frac{3}{5} \\end{bmatrix}\n   $$\n\n## Finding $\\mathbf{q}_2$\n\nTo find $\\mathbf{q}_2$, project $\\mathbf{a}_2$ onto $\\mathbf{q}_1$ and then subtract this projection from $\\mathbf{a}_2$.\n\n1. **Calculate the projection of $\\mathbf{a}_2$ onto $\\mathbf{q}_1$**:\n\n   $$\n   \\text{proj}_{\\mathbf{q}_1} \\mathbf{a}_2 = \\left( \\mathbf{a}_2 \\cdot \\mathbf{q}_1 \\right) \\mathbf{q}_1\n   $$\n\n   Since $\\mathbf{q}_1$ is a unit vector, $\\mathbf{q}_1 \\cdot \\mathbf{q}_1 = 1$.\n\n2. **Compute $\\mathbf{a}_2 \\cdot \\mathbf{q}_1$**:\n\n   $$\n   \\mathbf{a}_2 \\cdot \\mathbf{q}_1 = \\begin{bmatrix} 8 \\\\ 2 \\\\ 6 \\end{bmatrix} \\cdot \\begin{bmatrix} \\frac{4}{5} \\\\ 0 \\\\ \\frac{3}{5} \\end{bmatrix} = \\frac{32}{5} + 0 + \\frac{18}{5} = \\frac{50}{5} = 10\n   $$\n\n3. **Calculate $\\text{proj}_{\\mathbf{q}_1} \\mathbf{a}_2$**:\n\n   $$\n   \\text{proj}_{\\mathbf{q}_1} \\mathbf{a}_2 = 10 \\begin{bmatrix} \\frac{4}{5} \\\\ 0 \\\\ \\frac{3}{5} \\end{bmatrix} = \\begin{bmatrix} 8 \\\\ 0 \\\\ 6 \\end{bmatrix}\n   $$\n\n4. **Calculate $\\mathbf{u}_2$**:\n\n   Subtracting the projection from $\\mathbf{a}_2$ gives $\\mathbf{u}_2$:\n\n   $$\n   \\mathbf{u}_2 = \\mathbf{a}_2 - \\text{proj}_{\\mathbf{q}_1} \\mathbf{a}_2 = \\begin{bmatrix} 8 \\\\ 2 \\\\ 6 \\end{bmatrix} - \\begin{bmatrix} 8 \\\\ 0 \\\\ 6 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\end{bmatrix}\n   $$\n\n5. **Normalize $\\mathbf{u}_2$ to obtain $\\mathbf{q}_2$**:\n\n   The norm of $\\mathbf{u}_2$ is:\n\n   $$\n   \\|\\mathbf{u}_2\\| = \\sqrt{0^2 + 2^2 + 0^2} = 2\n   $$\n\n   Thus,\n\n   $$\n   \\mathbf{q}_2 = \\frac{\\mathbf{u}_2}{\\|\\mathbf{u}_2\\|} = \\frac{1}{2} \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}\n   $$\n\n## Finding $\\mathbf{q}_3$\n\nTo find $\\mathbf{q}_3$, project $\\mathbf{a}_3$ onto both $\\mathbf{q}_1$ and $\\mathbf{q}_2$, and then subtract these projections from $\\mathbf{a}_3$.\n\n1. **Calculate the projection of $\\mathbf{a}_3$ onto $\\mathbf{q}_1$**:\n\n   $$\n   \\mathbf{a}_3 \\cdot \\mathbf{q}_1 = \\begin{bmatrix} 1 \\\\ -2 \\\\ 7 \\end{bmatrix} \\cdot \\begin{bmatrix} \\frac{4}{5} \\\\ 0 \\\\ \\frac{3}{5} \\end{bmatrix} = \\frac{4}{5} + 0 + \\frac{21}{5} = \\frac{25}{5} = 5\n   $$\n\n   Then,\n\n   $$\n   \\text{proj}_{\\mathbf{q}_1} \\mathbf{a}_3 = 5 \\begin{bmatrix} \\frac{4}{5} \\\\ 0 \\\\ \\frac{3}{5} \\end{bmatrix} = \\begin{bmatrix} 4 \\\\ 0 \\\\ 3 \\end{bmatrix}\n   $$\n\n2. **Calculate the projection of $\\mathbf{a}_3$ onto $\\mathbf{q}_2$**:\n\n   $$\n   \\mathbf{a}_3 \\cdot \\mathbf{q}_2 = \\begin{bmatrix} 1 \\\\ -2 \\\\ 7 \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = -2\n   $$\n\n   Then,\n\n   $$\n   \\text{proj}_{\\mathbf{q}_2} \\mathbf{a}_3 = -2 \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -2 \\\\ 0 \\end{bmatrix}\n   $$\n\n3. **Calculate $\\mathbf{u}_3$**:\n\n   Subtracting both projections from $\\mathbf{a}_3$ yields $\\mathbf{u}_3$:\n\n   $$\n   \\mathbf{u}_3 = \\mathbf{a}_3 - \\text{proj}_{\\mathbf{q}_1} \\mathbf{a}_3 - \\text{proj}_{\\mathbf{q}_2} \\mathbf{a}_3 = \\begin{bmatrix} 1 \\\\ -2 \\\\ 7 \\end{bmatrix} - \\begin{bmatrix} 4 \\\\ 0 \\\\ 3 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ -2 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} -3 \\\\ 0 \\\\ 4 \\end{bmatrix}\n   $$\n\n4. **Normalize $\\mathbf{u}_3$ to obtain $\\mathbf{q}_3$**:\n\n   The norm of $\\mathbf{u}_3$ is:\n\n   $$\n   \\|\\mathbf{u}_3\\| = \\sqrt{(-3)^2 + 0^2 + 4^2} = \\sqrt{9 + 16} = \\sqrt{25} = 5\n   $$\n\n   Thus,\n\n   $$\n   \\mathbf{q}_3 = \\frac{\\mathbf{u}_3}{\\|\\mathbf{u}_3\\|} = \\frac{1}{5} \\begin{bmatrix} -3 \\\\ 0 \\\\ 4 \\end{bmatrix} = \\begin{bmatrix} -\\frac{3}{5} \\\\ 0 \\\\ \\frac{4}{5} \\end{bmatrix}\n   $$\n\n## Constructing $\\mathbf{Q}$ and $\\mathbf{R}$ Matrices\n\n### Orthogonal Matrix $\\mathbf{Q}$\n\nCombine $\\mathbf{q}_1$, $\\mathbf{q}\\_2$, and $\\mathbf{q}_3$ as columns to form $\\mathbf{Q}$:\n\n$$\n\\mathbf{Q} = \\begin{bmatrix} \\frac{4}{5} & 0 & -\\frac{3}{5} \\\\ 0 & 1 & 0 \\\\ \\frac{3}{5} & 0 & \\frac{4}{5} \\end{bmatrix}\n$$\n\n### Upper Triangular Matrix $\\mathbf{R}$\n\nThe entries of $\\mathbf{R}$ are calculated as the dot products of the original columns of $\\mathbf{A}$ with the orthonormal vectors $\\mathbf{q}_1$, $\\mathbf{q}_2$, and $\\mathbf{q}_3$:\n\n$$\n\\mathbf{R} = \\begin{bmatrix} \\mathbf{a}_1 \\cdot \\mathbf{q}_1 & \\mathbf{a}_2 \\cdot \\mathbf{q}_1 & \\mathbf{a}_3 \\cdot \\mathbf{q}_1 \\\\ 0 & \\mathbf{a}_2 \\cdot \\mathbf{q}_2 & \\mathbf{a}_3 \\cdot \\mathbf{q}_2 \\\\ 0 & 0 & \\mathbf{a}_3 \\cdot \\mathbf{q}_3 \\end{bmatrix} = \\begin{bmatrix} 5 & 10 & 5 \\\\ 0 & 2 & -2 \\\\ 0 & 0 & 5 \\end{bmatrix}\n$$\n\n::: {.callout-tip icon=false}\n\n## **Final Answer:**\n\nThe QR factorization of $\\mathbf{A}$ is:\n\n$$\n\\mathbf{A} = \\mathbf{Q} \\mathbf{R} = \\begin{bmatrix} \\frac{4}{5} & 0 & -\\frac{3}{5} \\\\ 0 & 1 & 0 \\\\ \\frac{3}{5} & 0 & \\frac{4}{5} \\end{bmatrix} \\begin{bmatrix} 5 & 10 & 5 \\\\ 0 & 2 & -2 \\\\ 0 & 0 & 5 \\end{bmatrix}\n$$\n\n:::\n\n",
    "supporting": [
      "exercise10-1-1d_files"
    ],
    "filters": [],
    "includes": {}
  }
}